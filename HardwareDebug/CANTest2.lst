   1                             		.file	"CANTest2.c"
   2                             		.section P,"ax"
   3                             	.Ltext0:
   4                             		.section	.text.can0_switch_mode,"ax",@progbits
   5                             		.global	_can0_switch_mode
   7                             	_can0_switch_mode:
   8                             	.LFB0:
   9                             		.file 1 "../src/CANTest2.c"
   1:../src/CANTest2.c **** /***************************************************************/
   2:../src/CANTest2.c **** /*                                                             */
   3:../src/CANTest2.c **** /*      PROJECT NAME :  CANTest2                               */
   4:../src/CANTest2.c **** /*      FILE         :  CANTest2.c                             */
   5:../src/CANTest2.c **** /*      DESCRIPTION  :  Main Program                           */
   6:../src/CANTest2.c **** /*                                                             */
   7:../src/CANTest2.c **** /*      This file was generated by e2 studio.                  */
   8:../src/CANTest2.c **** /*                                                             */
   9:../src/CANTest2.c **** /***************************************************************/
  10:../src/CANTest2.c **** 
  11:../src/CANTest2.c **** #include <iodefine.h>
  12:../src/CANTest2.c **** 
  13:../src/CANTest2.c **** #define TIMEOUT_COUNTER_DEFAULT 0x20000
  14:../src/CANTest2.c **** 
  15:../src/CANTest2.c **** #define RESULT_OK 0
  16:../src/CANTest2.c **** #define RESULT_ERROR 1
  17:../src/CANTest2.c **** #define RESULT_TIMEOUT 2
  18:../src/CANTest2.c **** #define RESULT_INVALID -1
  19:../src/CANTest2.c **** 
  20:../src/CANTest2.c **** #define CAN_MODE_OPERATE 0
  21:../src/CANTest2.c **** #define CAN_MODE_RESET 1
  22:../src/CANTest2.c **** #define CAN_MODE_HALT 2
  23:../src/CANTest2.c **** #define CAN_MODE_FORCE_RESET 3
  24:../src/CANTest2.c **** 
  25:../src/CANTest2.c **** #define CAN_FRAME_DATA 0
  26:../src/CANTest2.c **** #define CAN_FRAME_REMOTE 1
  27:../src/CANTest2.c **** 
  28:../src/CANTest2.c **** #ifdef CPPAPP
  29:../src/CANTest2.c **** //Initialize global constructors
  30:../src/CANTest2.c **** extern void __main()
  31:../src/CANTest2.c **** {
  32:../src/CANTest2.c ****   static int initialized;
  33:../src/CANTest2.c ****   if (! initialized)
  34:../src/CANTest2.c ****     {
  35:../src/CANTest2.c ****       typedef void (*pfunc) ();
  36:../src/CANTest2.c ****       extern pfunc __ctors[];
  37:../src/CANTest2.c ****       extern pfunc __ctors_end[];
  38:../src/CANTest2.c ****       pfunc *p;
  39:../src/CANTest2.c **** 
  40:../src/CANTest2.c ****       initialized = 1;
  41:../src/CANTest2.c ****       for (p = __ctors_end; p > __ctors; )
  42:../src/CANTest2.c ****     (*--p) ();
  43:../src/CANTest2.c **** 
  44:../src/CANTest2.c ****     }
  45:../src/CANTest2.c **** }
  46:../src/CANTest2.c **** #endif 
  47:../src/CANTest2.c **** 
  48:../src/CANTest2.c **** typedef struct {
  49:../src/CANTest2.c **** 	int id;
  50:../src/CANTest2.c **** 	int dlc;
  51:../src/CANTest2.c **** 	char data[8];
  52:../src/CANTest2.c **** } can_frame_t;
  53:../src/CANTest2.c **** 
  54:../src/CANTest2.c **** int can0_switch_mode(int mode_code) {
  10                             		.loc 1 54 0
  11 0000 7E A6                   		push.l	r6
  12                             	.LCFI0:
  13 0002 71 06 F8                		add	#-8, r0, r6
  14                             	.LCFI1:
  15 0005 EF 60                   		mov.L	r6, r0
  16                             	.LCFI2:
  17 0007 A0 69                   		mov.L	r1, 4[r6]
  55:../src/CANTest2.c **** 	int timeout_counter = TIMEOUT_COUNTER_DEFAULT;
  18                             		.loc 1 55 0
  19 0009 F8 6E 00 00 02          		mov.L	#0x20000, [r6]
  56:../src/CANTest2.c **** 
  57:../src/CANTest2.c **** 	switch (mode_code) {
  20                             		.loc 1 57 0
  21 000e A8 6D                   		mov.L	4[r6], r5
  22 0010 61 15                   		cmp	#1, r5
  23 0012 3A F3 00                		beq	.L3
  24 0015 61 25                   		cmp	#2, r5
  25 0017 3A A2 00                		beq	.L4
  26 001a 61 05                   		cmp	#0, r5
  27 001c 3B 33 01                		bne	.L20
  58:../src/CANTest2.c **** 	case CAN_MODE_OPERATE:
  59:../src/CANTest2.c **** 		MSTP(CAN0) = 0;
  28                             		.loc 1 59 0
  29 001f FB 5E 00 00 08          		mov.L	#0x80000, r5
  30 0024 A9 5C                   		mov.L	20[r5], r4
  31 0026 75 24 FE                		and	#-2, r4
  32 0029 A1 5C                   		mov.L	r4, 20[r5]
  60:../src/CANTest2.c **** 		while (MSTP(CAN0) && (--timeout_counter != 0))
  33                             		.loc 1 60 0
  34 002b 03                      		nop
  35                             	.L7:
  36                             		.loc 1 60 0 is_stmt 0 discriminator 1
  37 002c FB 5E 00 00 08          		mov.L	#0x80000, r5
  38 0031 A9 5D                   		mov.L	20[r5], r5
  39 0033 64 15                   		and	#1, r5
  40 0035 5B 55                   		movu.B	r5, r5
  41 0037 61 05                   		cmp	#0, r5
  42 0039 20 0E                   		beq	.L6
  43                             		.loc 1 60 0 discriminator 2
  44 003b EC 65                   		mov.L	[r6], r5
  45 003d 60 15                   		sub	#1, r5
  46 003f E3 65                   		mov.L	r5, [r6]
  47 0041 EC 65                   		mov.L	[r6], r5
  48 0043 61 05                   		cmp	#0, r5
  49 0045 21 E7                   		bne	.L7
  50                             	.L6:
  61:../src/CANTest2.c **** 			;
  62:../src/CANTest2.c **** 		if (timeout_counter == 0)
  51                             		.loc 1 62 0 is_stmt 1
  52 0047 EC 65                   		mov.L	[r6], r5
  53 0049 61 05                   		cmp	#0, r5
  54 004b 1E                      		bne	.L8
  63:../src/CANTest2.c **** 			return RESULT_TIMEOUT;
  55                             		.loc 1 63 0
  56 004c 66 25                   		mov.L	#2, r5
  57 004e 38 04 01                		bra	.L9
  58                             	.L8:
  64:../src/CANTest2.c **** 
  65:../src/CANTest2.c **** 		timeout_counter = TIMEOUT_COUNTER_DEFAULT;
  59                             		.loc 1 65 0
  60 0051 F8 6E 00 00 02          		mov.L	#0x20000, [r6]
  66:../src/CANTest2.c **** 		CAN0.CTLR.BIT.CANM = mode_code;
  61                             		.loc 1 66 0
  62 0056 FB 5E 00 02 09          		mov.L	#0x90200, r5
  63 005b A8 6C                   		mov.L	4[r6], r4
  64 005d 64 34                   		and	#3, r4
  65 005f 5B 44                   		movu.B	r4, r4
  66 0061 64 34                   		and	#3, r4
  67 0063 6C 84                   		shll	#8, r4
  68 0065 DE 53 20 03             		mov.W	1600[r5], r3
  69 0069 76 23 FF FC             		and	#0xfffffcff, r3
  70 006d 57 34                   		or	r3, r4
  71 006f DB 54 20 03             		mov.W	r4, 1600[r5]
  67:../src/CANTest2.c **** 		while ((CAN0.STR.BIT.RSTST || CAN0.STR.BIT.HLTST) && (--timeout_counter != 0))
  72                             		.loc 1 67 0
  73 0073 03                      		nop
  74                             	.L12:
  75                             		.loc 1 67 0 is_stmt 0 discriminator 1
  76 0074 FB 5E 00 02 09          		mov.L	#0x90200, r5
  77 0079 DE 55 21 03             		mov.W	1602[r5], r5
  78 007d 5F 55                   		movu.W	r5, r5
  79 007f 68 85                   		shlr	#8, r5
  80 0081 64 15                   		and	#1, r5
  81 0083 5B 55                   		movu.B	r5, r5
  82 0085 61 05                   		cmp	#0, r5
  83 0087 21 17                   		bne	.L10
  84                             		.loc 1 67 0 discriminator 3
  85 0089 FB 5E 00 02 09          		mov.L	#0x90200, r5
  86 008e DE 55 21 03             		mov.W	1602[r5], r5
  87 0092 5F 55                   		movu.W	r5, r5
  88 0094 68 95                   		shlr	#9, r5
  89 0096 64 15                   		and	#1, r5
  90 0098 5B 55                   		movu.B	r5, r5
  91 009a 61 05                   		cmp	#0, r5
  92 009c 20 0E                   		beq	.L11
  93                             	.L10:
  94                             		.loc 1 67 0 discriminator 2
  95 009e EC 65                   		mov.L	[r6], r5
  96 00a0 60 15                   		sub	#1, r5
  97 00a2 E3 65                   		mov.L	r5, [r6]
  98 00a4 EC 65                   		mov.L	[r6], r5
  99 00a6 61 05                   		cmp	#0, r5
 100 00a8 21 CC                   		bne	.L12
 101                             	.L11:
  68:../src/CANTest2.c **** 			;
  69:../src/CANTest2.c **** 		if (timeout_counter == 0)
 102                             		.loc 1 69 0 is_stmt 1
 103 00aa EC 65                   		mov.L	[r6], r5
 104 00ac 61 05                   		cmp	#0, r5
 105 00ae 1E                      		bne	.L13
  70:../src/CANTest2.c **** 			return RESULT_TIMEOUT;
 106                             		.loc 1 70 0
 107 00af 66 25                   		mov.L	#2, r5
 108 00b1 38 A1 00                		bra	.L9
 109                             	.L13:
  71:../src/CANTest2.c **** 
  72:../src/CANTest2.c **** 		return RESULT_OK;
 110                             		.loc 1 72 0
 111 00b4 66 05                   		mov.L	#0, r5
 112 00b6 38 9C 00                		bra	.L9
 113                             	.L4:
  73:../src/CANTest2.c **** 
  74:../src/CANTest2.c **** 	case CAN_MODE_HALT:
  75:../src/CANTest2.c **** 		CAN0.CTLR.BIT.CANM = mode_code;
 114                             		.loc 1 75 0
 115 00b9 FB 5E 00 02 09          		mov.L	#0x90200, r5
 116 00be A8 6C                   		mov.L	4[r6], r4
 117 00c0 64 34                   		and	#3, r4
 118 00c2 5B 44                   		movu.B	r4, r4
 119 00c4 64 34                   		and	#3, r4
 120 00c6 6C 84                   		shll	#8, r4
 121 00c8 DE 53 20 03             		mov.W	1600[r5], r3
 122 00cc 76 23 FF FC             		and	#0xfffffcff, r3
 123 00d0 57 34                   		or	r3, r4
 124 00d2 DB 54 20 03             		mov.W	r4, 1600[r5]
  76:../src/CANTest2.c **** 		while ((!CAN0.STR.BIT.HLTST) && (--timeout_counter != 0))
 125                             		.loc 1 76 0
 126 00d6 03                      		nop
 127                             	.L15:
 128                             		.loc 1 76 0 is_stmt 0 discriminator 1
 129 00d7 FB 5E 00 02 09          		mov.L	#0x90200, r5
 130 00dc DE 55 21 03             		mov.W	1602[r5], r5
 131 00e0 5F 55                   		movu.W	r5, r5
 132 00e2 68 95                   		shlr	#9, r5
 133 00e4 64 15                   		and	#1, r5
 134 00e6 5B 55                   		movu.B	r5, r5
 135 00e8 61 05                   		cmp	#0, r5
 136 00ea 21 0E                   		bne	.L14
 137                             		.loc 1 76 0 discriminator 2
 138 00ec EC 65                   		mov.L	[r6], r5
 139 00ee 60 15                   		sub	#1, r5
 140 00f0 E3 65                   		mov.L	r5, [r6]
 141 00f2 EC 65                   		mov.L	[r6], r5
 142 00f4 61 05                   		cmp	#0, r5
 143 00f6 21 E1                   		bne	.L15
 144                             	.L14:
  77:../src/CANTest2.c **** 			;
  78:../src/CANTest2.c **** 		if (timeout_counter == 0)
 145                             		.loc 1 78 0 is_stmt 1
 146 00f8 EC 65                   		mov.L	[r6], r5
 147 00fa 61 05                   		cmp	#0, r5
 148 00fc 1D                      		bne	.L16
  79:../src/CANTest2.c **** 			return RESULT_TIMEOUT;
 149                             		.loc 1 79 0
 150 00fd 66 25                   		mov.L	#2, r5
 151 00ff 2E 53                   		bra	.L9
 152                             	.L16:
  80:../src/CANTest2.c **** 
  81:../src/CANTest2.c **** 		return RESULT_OK;
 153                             		.loc 1 81 0
 154 0101 66 05                   		mov.L	#0, r5
 155 0103 2E 4F                   		bra	.L9
 156                             	.L3:
  82:../src/CANTest2.c **** 
  83:../src/CANTest2.c **** 	case CAN_MODE_RESET:
  84:../src/CANTest2.c **** 		CAN0.CTLR.BIT.CANM = mode_code;
 157                             		.loc 1 84 0
 158 0105 FB 5E 00 02 09          		mov.L	#0x90200, r5
 159 010a A8 6C                   		mov.L	4[r6], r4
 160 010c 64 34                   		and	#3, r4
 161 010e 5B 44                   		movu.B	r4, r4
 162 0110 64 34                   		and	#3, r4
 163 0112 6C 84                   		shll	#8, r4
 164 0114 DE 53 20 03             		mov.W	1600[r5], r3
 165 0118 76 23 FF FC             		and	#0xfffffcff, r3
 166 011c 57 34                   		or	r3, r4
 167 011e DB 54 20 03             		mov.W	r4, 1600[r5]
  85:../src/CANTest2.c **** 		while ((!CAN0.STR.BIT.RSTST) && (--timeout_counter != 0))
 168                             		.loc 1 85 0
 169 0122 03                      		nop
 170                             	.L18:
 171                             		.loc 1 85 0 is_stmt 0 discriminator 1
 172 0123 FB 5E 00 02 09          		mov.L	#0x90200, r5
 173 0128 DE 55 21 03             		mov.W	1602[r5], r5
 174 012c 5F 55                   		movu.W	r5, r5
 175 012e 68 85                   		shlr	#8, r5
 176 0130 64 15                   		and	#1, r5
 177 0132 5B 55                   		movu.B	r5, r5
 178 0134 61 05                   		cmp	#0, r5
 179 0136 21 0E                   		bne	.L17
 180                             		.loc 1 85 0 discriminator 2
 181 0138 EC 65                   		mov.L	[r6], r5
 182 013a 60 15                   		sub	#1, r5
 183 013c E3 65                   		mov.L	r5, [r6]
 184 013e EC 65                   		mov.L	[r6], r5
 185 0140 61 05                   		cmp	#0, r5
 186 0142 21 E1                   		bne	.L18
 187                             	.L17:
  86:../src/CANTest2.c **** 			;
  87:../src/CANTest2.c **** 		if (timeout_counter == 0)
 188                             		.loc 1 87 0 is_stmt 1
 189 0144 EC 65                   		mov.L	[r6], r5
 190 0146 61 05                   		cmp	#0, r5
 191 0148 1C                      		bne	.L19
  88:../src/CANTest2.c **** 			return RESULT_TIMEOUT;
 192                             		.loc 1 88 0
 193 0149 66 25                   		mov.L	#2, r5
 194 014b 0F                      		bra	.L9
 195                             	.L19:
  89:../src/CANTest2.c **** 
  90:../src/CANTest2.c **** 		return RESULT_OK;
 196                             		.loc 1 90 0
 197 014c 66 05                   		mov.L	#0, r5
 198 014e 0C                      		bra	.L9
 199                             	.L20:
  91:../src/CANTest2.c **** 
  92:../src/CANTest2.c **** 	default:
  93:../src/CANTest2.c **** 		return RESULT_INVALID;
 200                             		.loc 1 93 0
 201 014f FB 56 FF                		mov.L	#-1, r5
 202                             		.balign 8,3,1
 203                             	.L9:
  94:../src/CANTest2.c **** 	}
  95:../src/CANTest2.c **** }
 204                             		.loc 1 95 0
 205 0152 EF 51                   		mov.L	r5, r1
 206 0154 3F 66 03                		rtsd	#12, r6-r6
 207                             	.LFE0:
 209 0157 03                      		.section	.text.can0_wakeup,"ax",@progbits
 210                             		.global	_can0_wakeup
 212                             	_can0_wakeup:
 213                             	.LFB1:
  96:../src/CANTest2.c **** 
  97:../src/CANTest2.c **** int can0_wakeup(void) {
 214                             		.loc 1 97 0
 215 0000 7E A6                   		push.l	r6
 216                             	.LCFI3:
 217 0002 71 06 FC                		add	#-4, r0, r6
 218                             	.LCFI4:
 219 0005 EF 60                   		mov.L	r6, r0
 220                             	.LCFI5:
  98:../src/CANTest2.c **** 	int timeout_counter = TIMEOUT_COUNTER_DEFAULT;
 221                             		.loc 1 98 0
 222 0007 F8 6E 00 00 02          		mov.L	#0x20000, [r6]
  99:../src/CANTest2.c **** 
 100:../src/CANTest2.c **** 	CAN0.CTLR.BIT.SLPM = 0;
 223                             		.loc 1 100 0
 224 000c FB 5E 00 02 09          		mov.L	#0x90200, r5
 225 0011 DE 54 20 03             		mov.W	1600[r5], r4
 226 0015 76 24 FF FB             		and	#0xfffffbff, r4
 227 0019 DB 54 20 03             		mov.W	r4, 1600[r5]
 101:../src/CANTest2.c **** 	while ((CAN0.STR.BIT.SLPST) && (--timeout_counter != 0))
 228                             		.loc 1 101 0
 229 001d 03                      		nop
 230                             	.L23:
 231                             		.loc 1 101 0 is_stmt 0 discriminator 1
 232 001e FB 5E 00 02 09          		mov.L	#0x90200, r5
 233 0023 DE 55 21 03             		mov.W	1602[r5], r5
 234 0027 5F 55                   		movu.W	r5, r5
 235 0029 68 A5                   		shlr	#10, r5
 236 002b 64 15                   		and	#1, r5
 237 002d 5B 55                   		movu.B	r5, r5
 238 002f 61 05                   		cmp	#0, r5
 239 0031 20 0E                   		beq	.L22
 240                             		.loc 1 101 0 discriminator 2
 241 0033 EC 65                   		mov.L	[r6], r5
 242 0035 60 15                   		sub	#1, r5
 243 0037 E3 65                   		mov.L	r5, [r6]
 244 0039 EC 65                   		mov.L	[r6], r5
 245 003b 61 05                   		cmp	#0, r5
 246 003d 21 E1                   		bne	.L23
 247                             	.L22:
 102:../src/CANTest2.c **** 		;
 103:../src/CANTest2.c **** 	if (timeout_counter == 0)
 248                             		.loc 1 103 0 is_stmt 1
 249 003f EC 65                   		mov.L	[r6], r5
 250 0041 61 05                   		cmp	#0, r5
 251 0043 1C                      		bne	.L24
 104:../src/CANTest2.c **** 		return RESULT_TIMEOUT;
 252                             		.loc 1 104 0
 253 0044 66 25                   		mov.L	#2, r5
 254 0046 0B                      		bra	.L25
 255                             	.L24:
 105:../src/CANTest2.c **** 
 106:../src/CANTest2.c **** 	return RESULT_OK;
 256                             		.loc 1 106 0
 257 0047 66 05                   		mov.L	#0, r5
 258                             	.L25:
 107:../src/CANTest2.c **** }
 259                             		.loc 1 107 0
 260 0049 EF 51                   		mov.L	r5, r1
 261 004b 3F 66 02                		rtsd	#8, r6-r6
 262                             	.LFE1:
 264                             		.section	.text.can0_sleep,"ax",@progbits
 265                             		.global	_can0_sleep
 267                             	_can0_sleep:
 268                             	.LFB2:
 108:../src/CANTest2.c **** 
 109:../src/CANTest2.c **** int can0_sleep(void) {
 269                             		.loc 1 109 0
 270 0000 7E A6                   		push.l	r6
 271                             	.LCFI6:
 272 0002 71 06 F8                		add	#-8, r0, r6
 273                             	.LCFI7:
 274 0005 EF 60                   		mov.L	r6, r0
 275                             	.LCFI8:
 110:../src/CANTest2.c **** 	int timeout_counter = TIMEOUT_COUNTER_DEFAULT;
 276                             		.loc 1 110 0
 277 0007 F8 6E 00 00 02          		mov.L	#0x20000, [r6]
 111:../src/CANTest2.c **** 
 112:../src/CANTest2.c **** 	int halt_result = can0_switch_mode(CAN_MODE_HALT);
 278                             		.loc 1 112 0
 279 000c 66 21                   		mov.L	#2, r1
 280 000e 05 00 00 00             		bsr	_can0_switch_mode
 281 0012 A0 69                   		mov.L	r1, 4[r6]
 113:../src/CANTest2.c **** 	if (halt_result != RESULT_OK)
 282                             		.loc 1 113 0
 283 0014 A8 6D                   		mov.L	4[r6], r5
 284 0016 61 05                   		cmp	#0, r5
 285 0018 15                      		beq	.L27
 114:../src/CANTest2.c **** 		return halt_result;
 286                             		.loc 1 114 0
 287 0019 A8 6D                   		mov.L	4[r6], r5
 288 001b 2E 3F                   		bra	.L28
 289                             	.L27:
 115:../src/CANTest2.c **** 
 116:../src/CANTest2.c **** 	CAN0.CTLR.BIT.SLPM = 1;
 290                             		.loc 1 116 0
 291 001d FB 5E 00 02 09          		mov.L	#0x90200, r5
 292 0022 DE 54 20 03             		mov.W	1600[r5], r4
 293 0026 76 34 00 04             		or	#0x400, r4
 294 002a DB 54 20 03             		mov.W	r4, 1600[r5]
 117:../src/CANTest2.c **** 	while ((!CAN0.STR.BIT.SLPST) && (--timeout_counter != 0))
 295                             		.loc 1 117 0
 296 002e 03                      		nop
 297                             	.L30:
 298                             		.loc 1 117 0 is_stmt 0 discriminator 1
 299 002f FB 5E 00 02 09          		mov.L	#0x90200, r5
 300 0034 DE 55 21 03             		mov.W	1602[r5], r5
 301 0038 5F 55                   		movu.W	r5, r5
 302 003a 68 A5                   		shlr	#10, r5
 303 003c 64 15                   		and	#1, r5
 304 003e 5B 55                   		movu.B	r5, r5
 305 0040 61 05                   		cmp	#0, r5
 306 0042 21 0E                   		bne	.L29
 307                             		.loc 1 117 0 discriminator 2
 308 0044 EC 65                   		mov.L	[r6], r5
 309 0046 60 15                   		sub	#1, r5
 310 0048 E3 65                   		mov.L	r5, [r6]
 311 004a EC 65                   		mov.L	[r6], r5
 312 004c 61 05                   		cmp	#0, r5
 313 004e 21 E1                   		bne	.L30
 314                             	.L29:
 118:../src/CANTest2.c **** 		;
 119:../src/CANTest2.c **** 	if (timeout_counter == 0)
 315                             		.loc 1 119 0 is_stmt 1
 316 0050 EC 65                   		mov.L	[r6], r5
 317 0052 61 05                   		cmp	#0, r5
 318 0054 1C                      		bne	.L31
 120:../src/CANTest2.c **** 		return RESULT_TIMEOUT;
 319                             		.loc 1 120 0
 320 0055 66 25                   		mov.L	#2, r5
 321 0057 0B                      		bra	.L28
 322                             	.L31:
 121:../src/CANTest2.c **** 
 122:../src/CANTest2.c **** 	return RESULT_OK;
 323                             		.loc 1 122 0
 324 0058 66 05                   		mov.L	#0, r5
 325                             	.L28:
 123:../src/CANTest2.c **** }
 326                             		.loc 1 123 0
 327 005a EF 51                   		mov.L	r5, r1
 328 005c 3F 66 03                		rtsd	#12, r6-r6
 329                             	.LFE2:
 331                             		.section	.text.can0_set_bitrate,"ax",@progbits
 332                             		.global	_can0_set_bitrate
 334                             	_can0_set_bitrate:
 335                             	.LFB3:
 124:../src/CANTest2.c **** 
 125:../src/CANTest2.c **** int can0_set_bitrate(int bitrate_kbps, int prescaler, int pclk_mhz) {
 336                             		.loc 1 125 0
 337 0000 6E 67                   		pushm	r6-r7
 338                             	.LCFI9:
 339 0002 71 06 E0                		add	#-32, r0, r6
 340                             	.LCFI10:
 341 0005 EF 60                   		mov.L	r6, r0
 342                             	.LCFI11:
 343 0007 A1 69                   		mov.L	r1, 20[r6]
 344 0009 A1 E2                   		mov.L	r2, 24[r6]
 345 000b A1 EB                   		mov.L	r3, 28[r6]
 126:../src/CANTest2.c **** 	// 500 4 50
 127:../src/CANTest2.c **** 	if (bitrate_kbps < 0 || 1000 < bitrate_kbps)
 346                             		.loc 1 127 0
 347 000d A9 6D                   		mov.L	20[r6], r5
 348 000f 61 05                   		cmp	#0, r5
 349 0011 29 0A                   		blt	.L33
 350                             		.loc 1 127 0 is_stmt 0 discriminator 1
 351 0013 A9 6D                   		mov.L	20[r6], r5
 352 0015 76 05 E8 03             		cmp	#0x3e8, r5
 353 0019 2B 08                   		ble	.L34
 354                             	.L33:
 128:../src/CANTest2.c **** 		return RESULT_INVALID;
 355                             		.loc 1 128 0 is_stmt 1
 356 001b FB 56 FF                		mov.L	#-1, r5
 357 001e 38 F6 00                		bra	.L35
 358                             	.L34:
 129:../src/CANTest2.c **** 
 130:../src/CANTest2.c **** 	if (prescaler < 1 || 1024 < prescaler)
 359                             		.loc 1 130 0
 360 0021 A9 E5                   		mov.L	24[r6], r5
 361 0023 61 05                   		cmp	#0, r5
 362 0025 2B 0A                   		ble	.L36
 363                             		.loc 1 130 0 is_stmt 0 discriminator 1
 364 0027 A9 E5                   		mov.L	24[r6], r5
 365 0029 76 05 00 04             		cmp	#0x400, r5
 366 002d 2B 08                   		ble	.L37
 367                             	.L36:
 131:../src/CANTest2.c **** 		return RESULT_INVALID;
 368                             		.loc 1 131 0 is_stmt 1
 369 002f FB 56 FF                		mov.L	#-1, r5
 370 0032 38 E2 00                		bra	.L35
 371                             	.L37:
 132:../src/CANTest2.c **** 
 133:../src/CANTest2.c **** 	if (pclk_mhz < 0 || 50 < pclk_mhz)
 372                             		.loc 1 133 0
 373 0035 A9 ED                   		mov.L	28[r6], r5
 374 0037 61 05                   		cmp	#0, r5
 375 0039 29 09                   		blt	.L38
 376                             		.loc 1 133 0 is_stmt 0 discriminator 1
 377 003b A9 ED                   		mov.L	28[r6], r5
 378 003d 75 55 32                		cmp	#50, r5
 379 0040 2B 08                   		ble	.L39
 380                             	.L38:
 134:../src/CANTest2.c **** 		return RESULT_INVALID;
 381                             		.loc 1 134 0 is_stmt 1
 382 0042 FB 56 FF                		mov.L	#-1, r5
 383 0045 38 CF 00                		bra	.L35
 384                             	.L39:
 135:../src/CANTest2.c **** 
 136:../src/CANTest2.c **** 	int fcanclk = pclk_mhz * 1000000 / prescaler;
 385                             		.loc 1 136 0
 386 0048 A9 ED                   		mov.L	28[r6], r5
 387 004a FB 4E 40 42 0F          		mov.L	#0xf4240, r4
 388 004f 4F 54                   		mul	r5, r4
 389 0051 A9 E5                   		mov.L	24[r6], r5
 390 0053 EF 47                   		mov.L	r4, r7
 391 0055 FC 23 57                		div	r5, r7
 392 0058 EF 75                   		mov.L	r7, r5
 393 005a E3 65                   		mov.L	r5, [r6]
 137:../src/CANTest2.c **** 	int tq_total = fcanclk / (bitrate_kbps * 1000);
 394                             		.loc 1 137 0
 395 005c A9 6D                   		mov.L	20[r6], r5
 396 005e 76 15 E8 03             		mul	#0x3e8, r5
 397 0062 EC 64                   		mov.L	[r6], r4
 398 0064 EF 47                   		mov.L	r4, r7
 399 0066 FC 23 57                		div	r5, r7
 400 0069 EF 75                   		mov.L	r7, r5
 401 006b A0 6D                   		mov.L	r5, 4[r6]
 138:../src/CANTest2.c **** 
 139:../src/CANTest2.c **** 	if (tq_total < 8 || 25 < tq_total)
 402                             		.loc 1 139 0
 403 006d A8 6D                   		mov.L	4[r6], r5
 404 006f 61 75                   		cmp	#7, r5
 405 0071 2B 09                   		ble	.L40
 406                             		.loc 1 139 0 is_stmt 0 discriminator 1
 407 0073 A8 6D                   		mov.L	4[r6], r5
 408 0075 75 55 19                		cmp	#25, r5
 409 0078 2B 07                   		ble	.L41
 410                             	.L40:
 140:../src/CANTest2.c **** 		return RESULT_ERROR;
 411                             		.loc 1 140 0 is_stmt 1
 412 007a 66 15                   		mov.L	#1, r5
 413 007c 38 98 00                		bra	.L35
 414                             	.L41:
 141:../src/CANTest2.c **** 
 142:../src/CANTest2.c **** 	/*
 143:../src/CANTest2.c **** 	 *  <--------bit time-------->
 144:../src/CANTest2.c **** 	 *  |SS|    TSEG1    | TSEG2 |
 145:../src/CANTest2.c **** 	 *  +--+-------------+-------+-------+->t
 146:../src/CANTest2.c **** 	 *  0 1Tq            |    tq_total  25Tq
 147:../src/CANTest2.c **** 	 *          (tq_total - SS) * 2/3
 148:../src/CANTest2.c **** 	 *
 149:../src/CANTest2.c **** 	 *  e.g)
 150:../src/CANTest2.c **** 	 *  	tq_total = 25
 151:../src/CANTest2.c **** 	 *  	SS    = 1 Tq
 152:../src/CANTest2.c **** 	 *  	TSEG1 = 16 Tq
 153:../src/CANTest2.c **** 	 *  	TSEG2 = 8 Tq
 154:../src/CANTest2.c **** 	 *
 155:../src/CANTest2.c **** 	 *  	tq_total = 24
 156:../src/CANTest2.c **** 	 *  	SS    = 1 Tq
 157:../src/CANTest2.c **** 	 *  	TSEG1 = 15 Tq
 158:../src/CANTest2.c **** 	 *  	TSEG2 = 8 Tq
 159:../src/CANTest2.c **** 	 *
 160:../src/CANTest2.c **** 	 *  	tq_total = 8
 161:../src/CANTest2.c **** 	 *  	SS    = 1 Tq
 162:../src/CANTest2.c **** 	 *  	TSEG1 = 4 Tq
 163:../src/CANTest2.c **** 	 *  	TSEG2 = 3 Tq
 164:../src/CANTest2.c **** 	 */
 165:../src/CANTest2.c **** 	const int ss_tq = 1;
 415                             		.loc 1 165 0
 416 007f 3E 62 01                		mov.L	#1, 8[r6]
 166:../src/CANTest2.c **** 	int tseg1_tq = (tq_total - ss_tq) * 2 / 3;
 417                             		.loc 1 166 0
 418 0082 A8 6C                   		mov.L	4[r6], r4
 419 0084 A8 E5                   		mov.L	8[r6], r5
 420 0086 FF 05 54                		sub	r5, r4, r5
 421 0089 4B 55                   		add	r5, r5
 422 008b FD 74 85 03             		div	#3, r5
 423 008f A0 ED                   		mov.L	r5, 12[r6]
 167:../src/CANTest2.c **** 	int tseg2_tq = tq_total - ss_tq - tseg1_tq;
 424                             		.loc 1 167 0
 425 0091 A8 6C                   		mov.L	4[r6], r4
 426 0093 A8 E5                   		mov.L	8[r6], r5
 427 0095 43 54                   		sub	r5, r4
 428 0097 A8 ED                   		mov.L	12[r6], r5
 429 0099 FF 05 54                		sub	r5, r4, r5
 430 009c A1 65                   		mov.L	r5, 16[r6]
 168:../src/CANTest2.c **** 
 169:../src/CANTest2.c **** 	CAN0.BCR.BIT.SJW = 0; // ÊúÄÂêåÊúü„Ç∏„É£„É≥„ÉóÂπÖ; „ÄåÂÜçÂêåÊúü„Ç∏„É£„É≥„ÉóÂπÖ„ÅØÈÄöÂ∏∏Ôºë„Å®„Åô„Ç
 431                             		.loc 1 169 0
 432 009e FB 5E 00 02 09          		mov.L	#0x90200, r5
 433 00a3 EE 54 91 01             		mov.L	1604[r5], r4
 434 00a7 76 24 FF CF             		and	#0xffffcfff, r4
 435 00ab EB 54 91 01             		mov.L	r4, 1604[r5]
 170:../src/CANTest2.c **** 	CAN0.BCR.BIT.BRP = prescaler - 1;
 436                             		.loc 1 170 0
 437 00af FB 5E 00 02 09          		mov.L	#0x90200, r5
 438 00b4 A9 E4                   		mov.L	24[r6], r4
 439 00b6 60 14                   		sub	#1, r4
 440 00b8 76 24 FF 03             		and	#0x3ff, r4
 441 00bc 5F 44                   		movu.W	r4, r4
 442 00be 76 24 FF 03             		and	#0x3ff, r4
 443 00c2 6D 04                   		shll	#16, r4
 444 00c4 EE 53 91 01             		mov.L	1604[r5], r3
 445 00c8 74 23 FF FF 00 FC       		and	#0xfc00ffff, r3
 446 00ce 57 34                   		or	r3, r4
 447 00d0 EB 54 91 01             		mov.L	r4, 1604[r5]
 171:../src/CANTest2.c **** 	CAN0.BCR.BIT.TSEG1 = tseg1_tq - 1;
 448                             		.loc 1 171 0
 449 00d4 FB 5E 00 02 09          		mov.L	#0x90200, r5
 450 00d9 A8 EC                   		mov.L	12[r6], r4
 451 00db 60 14                   		sub	#1, r4
 452 00dd 64 F4                   		and	#15, r4
 453 00df 5B 44                   		movu.B	r4, r4
 454 00e1 6D C4                   		shll	#28, r4
 455 00e3 EE 53 91 01             		mov.L	1604[r5], r3
 456 00e7 74 23 FF FF FF 0F       		and	#0xfffffff, r3
 457 00ed 57 34                   		or	r3, r4
 458 00ef EB 54 91 01             		mov.L	r4, 1604[r5]
 172:../src/CANTest2.c **** 	CAN0.BCR.BIT.TSEG2 = tseg2_tq - 1;
 459                             		.loc 1 172 0
 460 00f3 FB 5E 00 02 09          		mov.L	#0x90200, r5
 461 00f8 A9 64                   		mov.L	16[r6], r4
 462 00fa 60 14                   		sub	#1, r4
 463 00fc 64 74                   		and	#7, r4
 464 00fe 5B 44                   		movu.B	r4, r4
 465 0100 64 74                   		and	#7, r4
 466 0102 6C 84                   		shll	#8, r4
 467 0104 EE 53 91 01             		mov.L	1604[r5], r3
 468 0108 76 23 FF F8             		and	#0xfffff8ff, r3
 469 010c 57 34                   		or	r3, r4
 470 010e EB 54 91 01             		mov.L	r4, 1604[r5]
 173:../src/CANTest2.c **** 
 174:../src/CANTest2.c **** 	return RESULT_OK;
 471                             		.loc 1 174 0
 472 0112 66 05                   		mov.L	#0, r5
 473                             		.balign 8,3,1
 474                             	.L35:
 175:../src/CANTest2.c **** }
 475                             		.loc 1 175 0
 476 0114 EF 51                   		mov.L	r5, r1
 477 0116 3F 67 0A                		rtsd	#40, r6-r7
 478                             	.LFE3:
 480 0119 FD 70 40 00 00 00 80    		.section	.text.can0_load_mailbox,"ax",@progbits
 481                             		.global	_can0_load_mailbox
 483                             	_can0_load_mailbox:
 484                             	.LFB4:
 176:../src/CANTest2.c **** 
 177:../src/CANTest2.c **** int can0_load_mailbox(int mb_number, can_frame_t frame, int frame_type, int oneshot) {
 485                             		.loc 1 177 0
 486 0000 6E 67                   		pushm	r6-r7
 487                             	.LCFI12:
 488 0002 71 06 E0                		add	#-32, r0, r6
 489                             	.LCFI13:
 490 0005 EF 60                   		mov.L	r6, r0
 491                             	.LCFI14:
 492 0007 75 45 2C                		mov.L	#44, r5
 493 000a 4B 65                   		add	r6, r5
 494 000c A0 69                   		mov.L	r1, 4[r6]
 178:../src/CANTest2.c **** 	int i = 0;
 495                             		.loc 1 178 0
 496 000e F8 66 00                		mov.L	#0, [r6]
 179:../src/CANTest2.c **** 
 180:../src/CANTest2.c **** 	if (mb_number < 0 || 31 < mb_number)
 497                             		.loc 1 180 0
 498 0011 A8 6C                   		mov.L	4[r6], r4
 499 0013 61 04                   		cmp	#0, r4
 500 0015 29 09                   		blt	.L43
 501                             		.loc 1 180 0 is_stmt 0 discriminator 1
 502 0017 A8 6C                   		mov.L	4[r6], r4
 503 0019 75 54 1F                		cmp	#31, r4
 504 001c 2B 08                   		ble	.L44
 505                             	.L43:
 181:../src/CANTest2.c **** 		return RESULT_INVALID;
 506                             		.loc 1 181 0 is_stmt 1
 507 001e FB 56 FF                		mov.L	#-1, r5
 508 0021 38 57 01                		bra	.L45
 509                             	.L44:
 182:../src/CANTest2.c **** 	if (frame.id < 0 || 0x1FFFFFFF < frame.id)
 510                             		.loc 1 182 0
 511 0024 EC 54                   		mov.L	[r5], r4
 512 0026 61 04                   		cmp	#0, r4
 513 0028 29 0C                   		blt	.L46
 514                             		.loc 1 182 0 is_stmt 0 discriminator 1
 515 002a EC 54                   		mov.L	[r5], r4
 516 002c 74 04 FF FF FF 1F       		cmp	#0x1fffffff, r4
 517 0032 2B 08                   		ble	.L47
 518                             	.L46:
 183:../src/CANTest2.c **** 		return RESULT_INVALID;
 519                             		.loc 1 183 0 is_stmt 1
 520 0034 FB 56 FF                		mov.L	#-1, r5
 521 0037 38 41 01                		bra	.L45
 522                             	.L47:
 184:../src/CANTest2.c **** 	if (frame.dlc < 0 || 8 < frame.dlc)
 523                             		.loc 1 184 0
 524 003a A8 5C                   		mov.L	4[r5], r4
 525 003c 61 04                   		cmp	#0, r4
 526 003e 29 08                   		blt	.L48
 527                             		.loc 1 184 0 is_stmt 0 discriminator 1
 528 0040 A8 5C                   		mov.L	4[r5], r4
 529 0042 61 84                   		cmp	#8, r4
 530 0044 2B 08                   		ble	.L49
 531                             	.L48:
 185:../src/CANTest2.c **** 		return RESULT_INVALID;
 532                             		.loc 1 185 0 is_stmt 1
 533 0046 FB 56 FF                		mov.L	#-1, r5
 534 0049 38 2F 01                		bra	.L45
 535                             	.L49:
 186:../src/CANTest2.c **** 	if (frame_type != CAN_FRAME_DATA && frame_type != CAN_FRAME_REMOTE)
 536                             		.loc 1 186 0
 537 004c A9 54                   		mov.L	16[r5], r4
 538 004e 61 04                   		cmp	#0, r4
 539 0050 20 0D                   		beq	.L50
 540                             		.loc 1 186 0 is_stmt 0 discriminator 1
 541 0052 A9 54                   		mov.L	16[r5], r4
 542 0054 61 14                   		cmp	#1, r4
 543 0056 17                      		beq	.L50
 187:../src/CANTest2.c **** 		return RESULT_INVALID;
 544                             		.loc 1 187 0 is_stmt 1
 545 0057 FB 56 FF                		mov.L	#-1, r5
 546 005a 38 1E 01                		bra	.L45
 547                             	.L50:
 188:../src/CANTest2.c **** 
 189:../src/CANTest2.c **** 	do {
 190:../src/CANTest2.c **** 		CAN0.MCTL[mb_number].BYTE = 0x00;
 548                             		.loc 1 190 0 discriminator 1
 549 005d FB 4E 00 02 09          		mov.L	#0x90200, r4
 550 0062 06 89 64 01             		add	4[r6].L, r4
 551 0066 72 44 20 06             		add	#0x620, r4
 552 006a F8 44 00                		mov.B	#0, [r4]
 191:../src/CANTest2.c **** 	} while (CAN0.MCTL[mb_number].BYTE != 0x00);
 553                             		.loc 1 191 0 discriminator 1
 554 006d FB 4E 00 02 09          		mov.L	#0x90200, r4
 555 0072 06 89 64 01             		add	4[r6].L, r4
 556 0076 72 44 20 06             		add	#0x620, r4
 557 007a CC 44                   		mov.B	[r4], r4
 558 007c 5B 44                   		movu.B	r4, r4
 559 007e 61 04                   		cmp	#0, r4
 560 0080 21 DD                   		bne	.L50
 192:../src/CANTest2.c **** 
 193:../src/CANTest2.c **** 	CAN0.MIER = 1 << mb_number;
 561                             		.loc 1 193 0
 562 0082 FB 4E 00 02 09          		mov.L	#0x90200, r4
 563 0087 66 12                   		mov.L	#1, r2
 564 0089 A8 6B                   		mov.L	4[r6], r3
 565 008b EF 27                   		mov.L	r2, r7
 566 008d FD 62 37                		shll	r3, r7
 567 0090 EF 73                   		mov.L	r7, r3
 568 0092 E7 43 8B                		mov.L	r3, 556[r4]
 194:../src/CANTest2.c **** 
 195:../src/CANTest2.c **** 	CAN0.MB[mb_number].ID.BIT.SID = frame.id;
 569                             		.loc 1 195 0
 570 0095 FB 2E 00 02 09          		mov.L	#0x90200, r2
 571 009a EC 54                   		mov.L	[r5], r4
 572 009c 76 24 FF 07             		and	#0x7ff, r4
 573 00a0 DF 43                   		mov.W	r4, r3
 574 00a2 A8 6C                   		mov.L	4[r6], r4
 575 00a4 6C 44                   		shll	#4, r4
 576 00a6 4B 24                   		add	r2, r4
 577 00a8 5F 33                   		movu.W	r3, r3
 578 00aa 76 23 FF 07             		and	#0x7ff, r3
 579 00ae 6D 23                   		shll	#18, r3
 580 00b0 EC 42                   		mov.L	[r4], r2
 581 00b2 74 22 FF FF 03 E0       		and	#0xe003ffff, r2
 582 00b8 57 23                   		or	r2, r3
 583 00ba E3 43                   		mov.L	r3, [r4]
 196:../src/CANTest2.c **** 	CAN0.MB[mb_number].ID.BIT.RTR = frame_type == CAN_FRAME_REMOTE;
 584                             		.loc 1 196 0
 585 00bc FB 2E 00 02 09          		mov.L	#0x90200, r2
 586 00c1 A9 54                   		mov.L	16[r5], r4
 587 00c3 61 14                   		cmp	#1, r4
 588 00c5 FC DB 40                		sceq.L	r4
 589 00c8 CF 43                   		mov.B	r4, r3
 590 00ca A8 6C                   		mov.L	4[r6], r4
 591 00cc 6C 44                   		shll	#4, r4
 592 00ce 4B 24                   		add	r2, r4
 593 00d0 5B 33                   		movu.B	r3, r3
 594 00d2 64 13                   		and	#1, r3
 595 00d4 6D E3                   		shll	#30, r3
 596 00d6 EC 42                   		mov.L	[r4], r2
 597 00d8 74 22 FF FF FF BF       		and	#0xbfffffff, r2
 598 00de 57 23                   		or	r2, r3
 599 00e0 E3 43                   		mov.L	r3, [r4]
 197:../src/CANTest2.c **** 	CAN0.MB[mb_number].ID.BIT.IDE = 0/*0x7FF < frame.id*/;
 600                             		.loc 1 197 0
 601 00e2 FB 3E 00 02 09          		mov.L	#0x90200, r3
 602 00e7 A8 6C                   		mov.L	4[r6], r4
 603 00e9 6C 44                   		shll	#4, r4
 604 00eb 4B 34                   		add	r3, r4
 605 00ed EC 43                   		mov.L	[r4], r3
 606 00ef 74 23 FF FF FF 7F       		and	#0x7fffffff, r3
 607 00f5 E3 43                   		mov.L	r3, [r4]
 198:../src/CANTest2.c **** 	CAN0.MB[mb_number].TS.WORD = 0x0000;
 608                             		.loc 1 198 0
 609 00f7 FB 3E 00 02 09          		mov.L	#0x90200, r3
 610 00fc A8 6C                   		mov.L	4[r6], r4
 611 00fe 6C 44                   		shll	#4, r4
 612 0100 4B 34                   		add	r3, r4
 613 0102 62 C4                   		add	#12, r4
 614 0104 3D 41 00                		mov.W	#0, 2[r4]
 199:../src/CANTest2.c **** 	CAN0.MB[mb_number].DLC.BIT.DLC = frame.dlc;
 615                             		.loc 1 199 0
 616 0107 FB 2E 00 02 09          		mov.L	#0x90200, r2
 617 010c A8 5C                   		mov.L	4[r5], r4
 618 010e 64 F4                   		and	#15, r4
 619 0110 CF 43                   		mov.B	r4, r3
 620 0112 A8 6C                   		mov.L	4[r6], r4
 621 0114 6C 44                   		shll	#4, r4
 622 0116 4B 24                   		add	r2, r4
 623 0118 62 44                   		add	#4, r4
 624 011a 5B 33                   		movu.B	r3, r3
 625 011c 64 F3                   		and	#15, r3
 626 011e DC 42                   		mov.W	[r4], r2
 627 0120 75 22 F0                		and	#-16, r2
 628 0123 57 23                   		or	r2, r3
 629 0125 D3 43                   		mov.W	r3, [r4]
 200:../src/CANTest2.c **** 	for (i = 0; i < 8; i++)
 630                             		.loc 1 200 0
 631 0127 F8 66 00                		mov.L	#0, [r6]
 632 012a 2E 23                   		bra	.L51
 633                             	.L52:
 201:../src/CANTest2.c **** 		CAN0.MB[mb_number].DATA[i] = frame.data[i];
 634                             		.loc 1 201 0 discriminator 2
 635 012c FB 2E 00 02 09          		mov.L	#0x90200, r2
 636 0131 EF 54                   		mov.L	r5, r4
 637 0133 06 88 64                		add	[r6].L, r4
 638 0136 62 84                   		add	#8, r4
 639 0138 CC 43                   		mov.B	[r4], r3
 640 013a A8 6C                   		mov.L	4[r6], r4
 641 013c 6C 44                   		shll	#4, r4
 642 013e 4B 24                   		add	r2, r4
 643 0140 06 88 64                		add	[r6].L, r4
 644 0143 62 44                   		add	#4, r4
 645 0145 80 C3                   		mov.B	r3, 2[r4]
 200:../src/CANTest2.c **** 	for (i = 0; i < 8; i++)
 646                             		.loc 1 200 0 discriminator 2
 647 0147 EC 64                   		mov.L	[r6], r4
 648 0149 62 14                   		add	#1, r4
 649 014b E3 64                   		mov.L	r4, [r6]
 650                             	.L51:
 200:../src/CANTest2.c **** 	for (i = 0; i < 8; i++)
 651                             		.loc 1 200 0 is_stmt 0 discriminator 1
 652 014d EC 64                   		mov.L	[r6], r4
 653 014f 61 74                   		cmp	#7, r4
 654 0151 2B DB                   		ble	.L52
 202:../src/CANTest2.c **** 
 203:../src/CANTest2.c **** 	CAN0.MCTL[mb_number].BIT.TX.ONESHOT = oneshot;
 655                             		.loc 1 203 0 is_stmt 1
 656 0153 FB 3E 00 02 09          		mov.L	#0x90200, r3
 657 0158 A9 5D                   		mov.L	20[r5], r5
 658 015a 64 15                   		and	#1, r5
 659 015c CF 54                   		mov.B	r5, r4
 660 015e EF 35                   		mov.L	r3, r5
 661 0160 06 89 65 01             		add	4[r6].L, r5
 662 0164 72 55 20 06             		add	#0x620, r5
 663 0168 64 14                   		and	#1, r4
 664 016a 6C 44                   		shll	#4, r4
 665 016c CC 53                   		mov.B	[r5], r3
 666 016e 75 23 EF                		and	#-17, r3
 667 0171 57 34                   		or	r3, r4
 668 0173 C3 54                   		mov.B	r4, [r5]
 204:../src/CANTest2.c **** 
 205:../src/CANTest2.c **** 	return RESULT_OK;
 669                             		.loc 1 205 0
 670 0175 66 05                   		mov.L	#0, r5
 671 0177 03                      		.balign 8,3,1
 672                             	.L45:
 206:../src/CANTest2.c **** }
 673                             		.loc 1 206 0
 674 0178 EF 51                   		mov.L	r5, r1
 675 017a 3F 67 0A                		rtsd	#40, r6-r7
 676                             	.LFE4:
 678 017d FC 13 00                		.section	.text.can0_transmit_mailbox,"ax",@progbits
 679                             		.global	_can0_transmit_mailbox
 681                             	_can0_transmit_mailbox:
 682                             	.LFB5:
 207:../src/CANTest2.c **** 
 208:../src/CANTest2.c **** int can0_transmit_mailbox(int mb_number) {
 683                             		.loc 1 208 0
 684 0000 7E A6                   		push.l	r6
 685                             	.LCFI15:
 686 0002 71 06 FC                		add	#-4, r0, r6
 687                             	.LCFI16:
 688 0005 EF 60                   		mov.L	r6, r0
 689                             	.LCFI17:
 690 0007 E3 61                   		mov.L	r1, [r6]
 209:../src/CANTest2.c **** 	if (mb_number < 0 || 31 < mb_number)
 691                             		.loc 1 209 0
 692 0009 EC 65                   		mov.L	[r6], r5
 693 000b 61 05                   		cmp	#0, r5
 694 000d 29 09                   		blt	.L54
 695                             		.loc 1 209 0 is_stmt 0 discriminator 1
 696 000f EC 65                   		mov.L	[r6], r5
 697 0011 75 55 1F                		cmp	#31, r5
 698 0014 2B 07                   		ble	.L55
 699                             	.L54:
 210:../src/CANTest2.c **** 		return RESULT_INVALID;
 700                             		.loc 1 210 0 is_stmt 1
 701 0016 FB 56 FF                		mov.L	#-1, r5
 702 0019 2E 2A                   		bra	.L56
 703                             	.L55:
 211:../src/CANTest2.c **** 
 212:../src/CANTest2.c **** 	CAN0.MCTL[mb_number].BIT.TX.RECREQ = 0;
 704                             		.loc 1 212 0
 705 001b FB 5E 00 02 09          		mov.L	#0x90200, r5
 706 0020 06 88 65                		add	[r6].L, r5
 707 0023 72 55 20 06             		add	#0x620, r5
 708 0027 CC 54                   		mov.B	[r5], r4
 709 0029 75 24 BF                		and	#0xffffffbf, r4
 710 002c C3 54                   		mov.B	r4, [r5]
 213:../src/CANTest2.c **** 	CAN0.MCTL[mb_number].BIT.TX.TRMREQ = 1;
 711                             		.loc 1 213 0
 712 002e FB 5E 00 02 09          		mov.L	#0x90200, r5
 713 0033 06 88 65                		add	[r6].L, r5
 714 0036 72 55 20 06             		add	#0x620, r5
 715 003a CC 54                   		mov.B	[r5], r4
 716 003c 75 34 80                		or	#0xffffff80, r4
 717 003f C3 54                   		mov.B	r4, [r5]
 214:../src/CANTest2.c **** 
 215:../src/CANTest2.c **** 	return RESULT_OK;
 718                             		.loc 1 215 0
 719 0041 66 05                   		mov.L	#0, r5
 720                             	.L56:
 216:../src/CANTest2.c **** }
 721                             		.loc 1 216 0
 722 0043 EF 51                   		mov.L	r5, r1
 723 0045 3F 66 02                		rtsd	#8, r6-r6
 724                             	.LFE5:
 726                             		.section	.text.main,"ax",@progbits
 727                             		.global	_main
 729                             	_main:
 730                             	.LFB6:
 217:../src/CANTest2.c **** 
 218:../src/CANTest2.c **** int main(void) {
 731                             		.loc 1 218 0
 732 0000 6E 6A                   		pushm	r6-r10
 733                             	.LCFI18:
 734 0002 71 06 E0                		add	#-32, r0, r6
 735                             	.LCFI19:
 736 0005 71 60 E8                		add	#-24, r6, r0
 737                             	.LCFI20:
 219:../src/CANTest2.c **** 	int switch_result = RESULT_OK;
 738                             		.loc 1 219 0
 739 0008 3E 61 00                		mov.L	#0, 4[r6]
 220:../src/CANTest2.c **** 	int i = 0;
 740                             		.loc 1 220 0
 741 000b F8 66 00                		mov.L	#0, [r6]
 221:../src/CANTest2.c **** 	char deadbeaf[8] = { 0xF0, 0xF1, 0xF2, 0xF3, 0xF4, 0xF5, 0xF6, 0xF7 };
 742                             		.loc 1 221 0
 743 000e F9 64 08 F0             		mov.B	#-16, 8[r6]
 744 0012 F9 64 09 F1             		mov.B	#-15, 9[r6]
 745 0016 F9 64 0A F2             		mov.B	#-14, 10[r6]
 746 001a F9 64 0B F3             		mov.B	#-13, 11[r6]
 747 001e F9 64 0C F4             		mov.B	#-12, 12[r6]
 748 0022 F9 64 0D F5             		mov.B	#-11, 13[r6]
 749 0026 F9 64 0E F6             		mov.B	#-10, 14[r6]
 750 002a F9 64 0F F7             		mov.B	#-9, 15[r6]
 222:../src/CANTest2.c **** 	can_frame_t deadbeaf_frame;
 223:../src/CANTest2.c **** 	deadbeaf_frame.id = 0x70F;
 751                             		.loc 1 223 0
 752 002e F9 6A 04 0F 07          		mov.L	#0x70f, 16[r6]
 224:../src/CANTest2.c **** 	deadbeaf_frame.dlc = 8;
 753                             		.loc 1 224 0
 754 0033 3E 65 08                		mov.L	#8, 20[r6]
 225:../src/CANTest2.c **** 	for (i = 0; i < 8; i++)
 755                             		.loc 1 225 0
 756 0036 F8 66 00                		mov.L	#0, [r6]
 757 0039 2E 18                   		bra	.L58
 758                             	.L59:
 226:../src/CANTest2.c **** 	    deadbeaf_frame.data[i] = deadbeaf[i];
 759                             		.loc 1 226 0 discriminator 2
 760 003b 71 65 08                		add	#8, r6, r5
 761 003e 06 88 65                		add	[r6].L, r5
 762 0041 CC 54                   		mov.B	[r5], r4
 763 0043 71 65 18                		add	#24, r6, r5
 764 0046 06 88 65                		add	[r6].L, r5
 765 0049 C3 54                   		mov.B	r4, [r5]
 225:../src/CANTest2.c **** 	for (i = 0; i < 8; i++)
 766                             		.loc 1 225 0 discriminator 2
 767 004b EC 65                   		mov.L	[r6], r5
 768 004d 62 15                   		add	#1, r5
 769 004f E3 65                   		mov.L	r5, [r6]
 770                             	.L58:
 225:../src/CANTest2.c **** 	for (i = 0; i < 8; i++)
 771                             		.loc 1 225 0 is_stmt 0 discriminator 1
 772 0051 EC 65                   		mov.L	[r6], r5
 773 0053 61 75                   		cmp	#7, r5
 774 0055 2B E6                   		ble	.L59
 227:../src/CANTest2.c **** //	can_frame_t deadbeaf_frame = { 0x48, 2, deadbeaf };
 228:../src/CANTest2.c **** 
 229:../src/CANTest2.c **** 	PORTA.DDR.BIT.B2 = 1;
 775                             		.loc 1 229 0 is_stmt 1
 776 0057 FB 5E 0A C0 08          		mov.L	#0x8c00a, r5
 777 005c CC 54                   		mov.B	[r5], r4
 778 005e 65 44                   		or	#4, r4
 779 0060 C3 54                   		mov.B	r4, [r5]
 230:../src/CANTest2.c **** 	PORTA.DDR.BIT.B3 = 1;
 780                             		.loc 1 230 0
 781 0062 FB 5E 0A C0 08          		mov.L	#0x8c00a, r5
 782 0067 CC 54                   		mov.B	[r5], r4
 783 0069 65 84                   		or	#8, r4
 784 006b C3 54                   		mov.B	r4, [r5]
 231:../src/CANTest2.c **** 	PORTA.DR.BIT.B2 = 1;
 785                             		.loc 1 231 0
 786 006d FB 5E 0A C0 08          		mov.L	#0x8c00a, r5
 787 0072 CD 54 20                		mov.B	32[r5], r4
 788 0075 65 44                   		or	#4, r4
 789 0077 C7 54 20                		mov.B	r4, 32[r5]
 232:../src/CANTest2.c **** 	PORTA.DR.BIT.B3 = 1;
 790                             		.loc 1 232 0
 791 007a FB 5E 0A C0 08          		mov.L	#0x8c00a, r5
 792 007f CD 54 20                		mov.B	32[r5], r4
 793 0082 65 84                   		or	#8, r4
 794 0084 C7 54 20                		mov.B	r4, 32[r5]
 233:../src/CANTest2.c **** 
 234:../src/CANTest2.c **** 	/**************************************
 235:../src/CANTest2.c **** 	 * Post-hardware-reset configurations *
 236:../src/CANTest2.c **** 	 **************************************/
 237:../src/CANTest2.c **** 
 238:../src/CANTest2.c **** 	IOPORT.PFJCAN.BIT.CANE = 1; // Enable CTX-A, CRX-A
 795                             		.loc 1 238 0
 796 0087 FB 5E 08 C1 08          		mov.L	#0x8c108, r5
 797 008c 8A DC                   		mov.B	11[r5], r4
 798 008e 65 14                   		or	#1, r4
 799 0090 82 DC                   		mov.B	r4, 11[r5]
 239:../src/CANTest2.c **** 	IOPORT.PFJCAN.BIT.CANS = 0; // PB5 = CTX-A; PB6 = CRX-A
 800                             		.loc 1 239 0
 801 0092 FB 5E 08 C1 08          		mov.L	#0x8c108, r5
 802 0097 8A DC                   		mov.B	11[r5], r4
 803 0099 75 24 3F                		and	#63, r4
 804 009c 82 DC                   		mov.B	r4, 11[r5]
 240:../src/CANTest2.c **** 	PORTB.DR.BIT.B5 = 1;        // PB5(CTX-A) = H
 805                             		.loc 1 240 0
 806 009e FB 5E 0B C0 08          		mov.L	#0x8c00b, r5
 807 00a3 CD 54 20                		mov.B	32[r5], r4
 808 00a6 75 34 20                		or	#32, r4
 809 00a9 C7 54 20                		mov.B	r4, 32[r5]
 241:../src/CANTest2.c **** 	PORTB.ICR.BIT.B6 = 1;       // ICR config for PB6(CRX-A)
 810                             		.loc 1 241 0
 811 00ac FB 5E 0B C0 08          		mov.L	#0x8c00b, r5
 812 00b1 CD 54 60                		mov.B	96[r5], r4
 813 00b4 75 34 40                		or	#64, r4
 814 00b7 C7 54 60                		mov.B	r4, 96[r5]
 242:../src/CANTest2.c **** 
 243:../src/CANTest2.c **** 	MSTP(CAN0) = 0;
 815                             		.loc 1 243 0
 816 00ba FB 5E 00 00 08          		mov.L	#0x80000, r5
 817 00bf A9 5C                   		mov.L	20[r5], r4
 818 00c1 75 24 FE                		and	#-2, r4
 819 00c4 A1 5C                   		mov.L	r4, 20[r5]
 244:../src/CANTest2.c **** 
 245:../src/CANTest2.c **** 	can0_wakeup();
 820                             		.loc 1 245 0
 821 00c6 05 00 00 00             		bsr	_can0_wakeup
 246:../src/CANTest2.c **** 
 247:../src/CANTest2.c **** 	PORTA.DR.BIT.B2 = can0_switch_mode(CAN_MODE_RESET);
 822                             		.loc 1 247 0
 823 00ca FB AE 0A C0 08          		mov.L	#0x8c00a, r10
 824 00cf 66 11                   		mov.L	#1, r1
 825 00d1 05 00 00 00             		bsr	_can0_switch_mode
 826 00d5 EF 15                   		mov.L	r1, r5
 827 00d7 64 15                   		and	#1, r5
 828 00d9 64 15                   		and	#1, r5
 829 00db 6C 25                   		shll	#2, r5
 830 00dd CD A4 20                		mov.B	32[r10], r4
 831 00e0 75 24 FB                		and	#-5, r4
 832 00e3 57 45                   		or	r4, r5
 833 00e5 C7 A5 20                		mov.B	r5, 32[r10]
 248:../src/CANTest2.c **** 
 249:../src/CANTest2.c **** 	CAN0.CTLR.BIT.MBM = 0;
 834                             		.loc 1 249 0
 835 00e8 FB 5E 00 02 09          		mov.L	#0x90200, r5
 836 00ed DE 54 20 03             		mov.W	1600[r5], r4
 837 00f1 75 24 FE                		and	#-2, r4
 838 00f4 DB 54 20 03             		mov.W	r4, 1600[r5]
 250:../src/CANTest2.c **** 	CAN0.CTLR.BIT.IDFM = 0;
 839                             		.loc 1 250 0
 840 00f8 FB 5E 00 02 09          		mov.L	#0x90200, r5
 841 00fd DE 54 20 03             		mov.W	1600[r5], r4
 842 0101 75 24 F9                		and	#-7, r4
 843 0104 DB 54 20 03             		mov.W	r4, 1600[r5]
 251:../src/CANTest2.c **** 	CAN0.CTLR.BIT.MLM = 0;
 844                             		.loc 1 251 0
 845 0108 FB 5E 00 02 09          		mov.L	#0x90200, r5
 846 010d DE 54 20 03             		mov.W	1600[r5], r4
 847 0111 75 24 F7                		and	#-9, r4
 848 0114 DB 54 20 03             		mov.W	r4, 1600[r5]
 252:../src/CANTest2.c **** 	CAN0.CTLR.BIT.TPM = 0;
 849                             		.loc 1 252 0
 850 0118 FB 5E 00 02 09          		mov.L	#0x90200, r5
 851 011d DE 54 20 03             		mov.W	1600[r5], r4
 852 0121 75 24 EF                		and	#-17, r4
 853 0124 DB 54 20 03             		mov.W	r4, 1600[r5]
 253:../src/CANTest2.c **** 	CAN0.CTLR.BIT.TSRC = 0;
 854                             		.loc 1 253 0
 855 0128 FB 5E 00 02 09          		mov.L	#0x90200, r5
 856 012d DE 54 20 03             		mov.W	1600[r5], r4
 857 0131 75 24 DF                		and	#-33, r4
 858 0134 DB 54 20 03             		mov.W	r4, 1600[r5]
 254:../src/CANTest2.c **** 	CAN0.CTLR.BIT.TSPS = 3;
 859                             		.loc 1 254 0
 860 0138 FB 5E 00 02 09          		mov.L	#0x90200, r5
 861 013d DE 54 20 03             		mov.W	1600[r5], r4
 862 0141 76 34 C0 00             		or	#0xc0, r4
 863 0145 DB 54 20 03             		mov.W	r4, 1600[r5]
 255:../src/CANTest2.c **** 	CAN0.CTLR.BIT.BOM = 0;
 864                             		.loc 1 255 0
 865 0149 FB 5E 00 02 09          		mov.L	#0x90200, r5
 866 014e DE 54 20 03             		mov.W	1600[r5], r4
 867 0152 76 24 FF E7             		and	#0xffffe7ff, r4
 868 0156 DB 54 20 03             		mov.W	r4, 1600[r5]
 256:../src/CANTest2.c **** 	CAN0.CTLR.BIT.RBOC = 0;
 869                             		.loc 1 256 0
 870 015a FB 5E 00 02 09          		mov.L	#0x90200, r5
 871 015f DE 54 20 03             		mov.W	1600[r5], r4
 872 0163 76 24 FF DF             		and	#0xffffdfff, r4
 873 0167 DB 54 20 03             		mov.W	r4, 1600[r5]
 257:../src/CANTest2.c **** 
 258:../src/CANTest2.c **** 	PORTA.DR.BIT.B3 = can0_set_bitrate(500, 4, 25);
 874                             		.loc 1 258 0
 875 016b FB AE 0A C0 08          		mov.L	#0x8c00a, r10
 876 0170 FB 1A F4 01             		mov.L	#0x1f4, r1
 877 0174 66 42                   		mov.L	#4, r2
 878 0176 75 43 19                		mov.L	#25, r3
 879 0179 05 00 00 00             		bsr	_can0_set_bitrate
 880 017d EF 15                   		mov.L	r1, r5
 881 017f 64 15                   		and	#1, r5
 882 0181 64 15                   		and	#1, r5
 883 0183 6C 35                   		shll	#3, r5
 884 0185 CD A4 20                		mov.B	32[r10], r4
 885 0188 75 24 F7                		and	#-9, r4
 886 018b 57 45                   		or	r4, r5
 887 018d C7 A5 20                		mov.B	r5, 32[r10]
 259:../src/CANTest2.c **** 
 260:../src/CANTest2.c **** 	CAN0.MIER = 0x00000000; // Prohibit all mailbox interrupts
 888                             		.loc 1 260 0
 889 0190 FB 5E 00 02 09          		mov.L	#0x90200, r5
 890 0195 F9 56 8B 00             		mov.L	#0, 556[r5]
 261:../src/CANTest2.c **** 	CAN0.EIER.BYTE = 0x00;  // Prohibit all error interrupts
 891                             		.loc 1 261 0
 892 0199 FB 5E 00 02 09          		mov.L	#0x90200, r5
 893 019e FA 54 4C 06 00          		mov.B	#0, 1612[r5]
 262:../src/CANTest2.c **** 
 263:../src/CANTest2.c **** 	for (i = 0; i < 32; i++) {
 894                             		.loc 1 263 0
 895 01a3 F8 66 00                		mov.L	#0, [r6]
 896 01a6 2E 21                   		bra	.L60
 897                             	.L61:
 264:../src/CANTest2.c **** 		CAN0.MKR[i].LONG = 0x00000000; // Will not be compared with any bits
 898                             		.loc 1 264 0 discriminator 2
 899 01a8 FB 5E 00 02 09          		mov.L	#0x90200, r5
 900 01ad EC 64                   		mov.L	[r6], r4
 901 01af 72 44 80 00             		add	#0x80, r4
 902 01b3 66 07                   		mov.L	#0, r7
 903 01b5 FE 24 57                		mov.L	r7, [r4,r5]
 265:../src/CANTest2.c **** 		CAN0.MKIVLR = 0x00000000;      // Enable all masks for each mailbox
 904                             		.loc 1 265 0 discriminator 2
 905 01b8 FB 5E 00 02 09          		mov.L	#0x90200, r5
 906 01bd F9 56 8A 00             		mov.L	#0, 552[r5]
 263:../src/CANTest2.c **** 		CAN0.MKR[i].LONG = 0x00000000; // Will not be compared with any bits
 907                             		.loc 1 263 0 discriminator 2
 908 01c1 EC 65                   		mov.L	[r6], r5
 909 01c3 62 15                   		add	#1, r5
 910 01c5 E3 65                   		mov.L	r5, [r6]
 911                             	.L60:
 263:../src/CANTest2.c **** 		CAN0.MKR[i].LONG = 0x00000000; // Will not be compared with any bits
 912                             		.loc 1 263 0 is_stmt 0 discriminator 1
 913 01c7 EC 65                   		mov.L	[r6], r5
 914 01c9 75 55 1F                		cmp	#31, r5
 915 01cc 2B DC                   		ble	.L61
 266:../src/CANTest2.c **** 	}
 267:../src/CANTest2.c **** 
 268:../src/CANTest2.c **** 	can0_switch_mode(CAN_MODE_OPERATE);
 916                             		.loc 1 268 0 is_stmt 1
 917 01ce 66 01                   		mov.L	#0, r1
 918 01d0 05 00 00 00             		bsr	_can0_switch_mode
 269:../src/CANTest2.c **** 
 270:../src/CANTest2.c **** 	can0_load_mailbox(0, deadbeaf_frame, CAN_FRAME_DATA, 0);
 919                             		.loc 1 270 0
 920 01d4 75 45 10                		mov.L	#16, r5
 921 01d7 EF 01                   		mov.L	r0, r1
 922 01d9 71 64 10                		add	#16, r6, r4
 923 01dc EF 42                   		mov.L	r4, r2
 924 01de EF 53                   		mov.L	r5, r3
 925 01e0 7F 8F                   		smovf
 926 01e2 3E 04 00                		mov.L	#0, 16[r0]
 927 01e5 3E 05 00                		mov.L	#0, 20[r0]
 928 01e8 66 01                   		mov.L	#0, r1
 929 01ea 05 00 00 00             		bsr	_can0_load_mailbox
 271:../src/CANTest2.c **** 	can0_transmit_mailbox(0);
 930                             		.loc 1 271 0
 931 01ee 66 01                   		mov.L	#0, r1
 932 01f0 05 00 00 00             		bsr	_can0_transmit_mailbox
 933                             	.L62:
 272:../src/CANTest2.c **** 
 273:../src/CANTest2.c ****     while(1) {
 274:../src/CANTest2.c ****     }
 934                             		.loc 1 274 0 discriminator 1
 935 01f4 2E 00                   		bra	.L62
 936                             	.LFE6:
 1130                             	.Letext0:
 1131                             		.file 2 "C:/Users/kosuke/Develop/RX/CANTest2/generate/iodefine.h"
